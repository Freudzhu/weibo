<?xml version="1.0" encoding="UTF-8"?> 
<!DOCTYPE mapper 
PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" 
"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd"> 
<mapper namespace="com.zhuhaihuan.weibo.mybatis.mapper.weibo.status">
    <!-- 定义一条查询语句，在bean的implementation中会引用此语句的id --> 
    <insert id="add" parameterType="Status"
     useGeneratedKeys="true" keyProperty="id"> 
        INSERT INTO status(uid,content,createtime,updatetime) 
        VALUES(#{user.uid},#{content},#{createtime},#{updatetime}) 
    </insert>
    <select id="findAllStatus" resultMap="statusResultMap" parameterType="User">  
        select m.id,m.uid,m.createtime,m.updatetime,m.content,u.username,u.email  
        from status m left join user u on m.uid = u.uid where u.username = #{username} 
    </select>  
    <resultMap type="Status" id="statusResultMap">  
        <id property="id" column="id" />  
        <result property="content" column="content" />  
        <result property="createtime" column="createtime" />  
        <result property="updatetime" column="updatetime" />  
        <association property="user" column="uid"  
            javaType="User" resultMap="com.zhuhaihuan.weibo.mybatis.mapper.weibo.user.userResultMap" />  
    </resultMap> 
</mapper>